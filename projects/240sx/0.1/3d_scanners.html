<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>3D Scanners :: Joshua Smith</title>
    <link rel="canonical" href="https://www.giliath.org/240sx/0.1/3d_scanners.html">
    <link rel="prev" href="background.html">
    <link rel="next" href="3d_models.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../favicon.ico" type="image/x-icon">    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a class="navbar-item" href="https://www.giliath.org">Joshua Smith</a>
        <span class="separator">//</span>
        <a href="https://www.giliath.org/projects">Projects</a>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="240sx" data-version="0.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="background.html">240SX EV Conversion</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="background.html">Background</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="3d_scanners.html">3D Scanners</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="3d_models.html">3D Models</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="component_layout.html">Component Layout</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="battery_boxes.html">Battery Boxes</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">240SX EV Conversion</span>
    <span class="version">0.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="background.html">240SX EV Conversion</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="background.html">0.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="background.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="background.html">240SX EV Conversion</a></li>
    <li><a href="3d_scanners.html">3D Scanners</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/joshwearssocks/joshwearssocks.github.io/edit/main/240sx/modules/ROOT/pages/3d_scanners.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">3D Scanners</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This project is complex enough to warrant buying a 3D scanner to aide in component layout,
but almost all 3D scanners with decent resolution and accuracy are prohibitively
expensive for a hobbyist.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hardware"><a class="anchor" href="#hardware"></a>Hardware</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Two scanners were used for this project: a Revopoint POP and a custom scanner based on an
RPLidar A1M8.</p>
</div>
<div class="sect2">
<h3 id="revopoint-pop"><a class="anchor" href="#revopoint-pop"></a>Revopoint POP</h3>
<div class="paragraph">
<p>Revopoint had recently released the POP 3D scanner, which was reasonably priced at around $650.
Creality also had a competing product, but the POP was more refined. The POP has 0.1mm accuracy.
I purchased the POP a few months before the POP2 was announced, which has 0.05mm accuracy and
a gyroscope to improve scan accuracy over larger targets.</p>
</div>
<div class="paragraph">
<p>The Revopoint POP is great for creating high resolution scans of small to medium sized objects,
but it lacks the precision needed to scan an entire vehicle chassis. Revopoint software
will automatically distort the scanned model to better align roughly overlapping sections.
This distortion is usually minimal and welcome on smaller models, but it becomes inaccurate on
larger models such as a vehicle chassis.</p>
</div>
</div>
<div class="sect2">
<h3 id="rplidar-based-scanner"><a class="anchor" href="#rplidar-based-scanner"></a>RPLidar Based Scanner</h3>
<div class="paragraph">
<p>A second scanner was needed for modelling the underbody of the car. 2D scanning lidar sensors
with reasonable accuracy are inexpensive.
The <a href="https://www.slamtec.com/en/Lidar/A1Spec">RPLidar A1M8</a> is $99 with an angular resolution of
1 degree and a range resolution of 1% of distance.
I planned to create a 3D scanner from this by mounting the lidar sensor to the powered
lazy suzan that came with the Revopoint POP.
A <a href="https://beagleboard.org/p/chronma/rplidar-based-3d-area-scanner-3ae946">similar project</a>
was open sourced which showed good potential for this idea.</p>
</div>
<div class="paragraph">
<p>The end result was a hacky looking and not very rigid scanner.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/3d_scanners/rplidar_scanner.png" alt="rplidar scanner">
</div>
<div class="title">Figure 1. RPLidar based 3D scanner</div>
</div>
<div class="paragraph">
<p>An ESP8266 is used to control the lazy suzan, receive data from the RPLidar, and transmit
the RPLidar data along with the azimuth angle to a host over wifi.</p>
</div>
<div class="paragraph">
<p>The poor rigidity of the structure is roughly made up for in software.
The <a href="https://github.com/joshwearssocks/rplidar_area_scanner">rplidar_area_scanner</a> repo
contains a script to adjust for various angles and offsets as a post processing step,
as shown below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/3d_scanners/file_pc_viewer.png" alt="file pc viewer">
</div>
<div class="title">Figure 2. file_pc_viewer.py example with rear wheels and the spare tire well in view</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="software"><a class="anchor" href="#software"></a>Software</h2>
<div class="sectionbody">
<div class="paragraph">
<p>3 different pieces of software are used to post process 3D scans:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.meshlab.net/">MeshLab</a> is used for point cloud cleanup,
simplification, and meshing.</p>
</li>
<li>
<p><a href="https://www.cloudcompare.org/">CloudCompare</a> is used to merge point clouds together.</p>
</li>
<li>
<p>Revopoint software (HandyScan/HandyStudio) is used to mesh point clouds collected from
the Revopoint POP.</p>
<div class="ulist">
<ul>
<li>
<p>Revopoint software typically creates smoother meshes at the expense of losing details that don&#8217;t have many points.</p>
</li>
<li>
<p>This software also supports mesh merging, but the merging process may distort the meshes.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="meshing-process"><a class="anchor" href="#meshing-process"></a>Meshing Process</h3>
<div class="paragraph">
<p>There are multiple ways to convert point clouds to meshes, but the following method produces
good quality meshes while maintaining as much of the original scan as possible.
The meshing process in Revopoint software tends to ignore portions of the point cloud that are
more isolated from the rest of the point cloud.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the mesh in Meshlab, then use the <b class="menuref">Select Vertices</b> and
<b class="menuref">Delete Selected Vertices</b> tools to clean up the mesh.</p>
<div class="imageblock">
<div class="content">
<img src="_images/3d_scanners/meshlab_cleanup.png" alt="meshlab cleanup">
</div>
<div class="title">Figure 3. Manual mesh cleanup</div>
</div>
</li>
<li>
<p>Simplify the mesh with <span class="menuseq"><b class="menu">Filters</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Sampling</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Poisson-disk Sampling</b></span>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/3d_scanners/meshlab_sampling.png" alt="meshlab sampling">
</div>
<div class="title">Figure 4. Vertex sampling</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>Base Mesh Subsampling</code> must be selected for vertex-only data.</p>
</li>
<li>
<p><code>Number of samples</code> is a balance between resulting mesh quality and size.
For more detailed meshes, 600,000 is a reasonable starting point.</p>
</li>
</ol>
</div>
</li>
<li>
<p>With the simplified point cloud selected, generate an initial mesh with
<span class="menuseq"><b class="menu">Filters</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Remeshing, Simplification and Reconstruction</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Surface Reconstruction: Screened Poisson</b></span>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/3d_scanners/meshlab_reconstruction.png" alt="meshlab reconstruction">
</div>
<div class="title">Figure 5. Surface reconstruction</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Higher reconstruction depth will improve the amount of detail in the mesh at the cost of compute
time. Too high of a reconstruction depth will make the mesh less smooth, especially if the
point cloud is not very dense.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The Screened Poisson reconstruction technique leaves excess mesh that must be trimmed away.
To trim the unwanted vertices in the mesh, first use
<span class="menuseq"><b class="menu">Filters</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Sampling</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Distance from Reference Mesh</b></span> to calculate the distances from the Poisson mesh
vertices to the original point cloud vertices.</p>
<div class="imageblock">
<div class="content">
<img src="_images/3d_scanners/meshlab_distances.png" alt="meshlab distances">
</div>
<div class="title">Figure 6. Mesh distance from original point cloud calculation</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Uncheck <code>Compute Signed Distance</code>.</p>
</li>
<li>
<p>The distance information is stored as vertex quality data in the Poisson mesh.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Select vertices that are not in close proximity to the reference mesh by using
<span class="menuseq"><b class="menu">Filters</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Selection</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Select by Vertex Quality</b></span>, where <code>Quality</code> is distance in mm.</p>
<div class="imageblock">
<div class="content">
<img src="_images/3d_scanners/meshlab_quality_selection.png" alt="meshlab quality selection">
</div>
<div class="title">Figure 7. Mesh vertex selection by quality</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select a <code>Min Quality</code> value that balances accuracy and appearance for your application.
The minimum distance will vary based on point density of the original point cloud.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Use the <b class="menuref">Delete Selected Vertices</b> tool to remove the unwanted vertices.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The final product is a reasonably smooth and lightweight mesh with high accuracy.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/3d_scanners/meshlab_final.png" alt="meshlab final">
</div>
<div class="title">Figure 8. Meshed point cloud</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="background.html">Background</a></span>
  <span class="next"><a href="3d_models.html">3D Models</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
